# –°–∏—Å—Ç–µ–º–∞ –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –û—Ç–µ–ª–µ–π (Hotel Reservation System)

–†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–µ–ª–µ–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ **Spring Boot 3.4** –∏ **Spring Cloud**. –ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö enterprise-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (ADR)](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ-—Ä–µ—à–µ–Ω–∏—è-adr)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É](#–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è-–ø–æ-–∑–∞–ø—É—Å–∫—É)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [API Reference](#api-reference)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–û–±—Å–µ—Ä–≤–∞–±–∏–ª–∏—Ç–∏](#–æ–±—Å–µ—Ä–≤–∞–±–∏–ª–∏—Ç–∏)
- [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)

---

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–µ–ª–µ–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è:

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–µ–ª—è–º–∏ –∏ –Ω–æ–º–µ—Ä–∞–º–∏** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤** ‚Äî —Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–º –ø–æ–¥–±–æ—Ä–æ–º –∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞–≥—Ä—É–∑–∫–∏
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** ‚Äî JWT-—Ç–æ–∫–µ–Ω—ã —Å —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª—å—é (USER/ADMIN)
- **–û–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö** ‚Äî –¥–≤—É—Ö—Ñ–∞–∑–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| **–î–≤—É—Ö—Ñ–∞–∑–Ω–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å** | –°–∞–≥–∞-–ø–∞—Ç—Ç–µ—Ä–Ω: `PENDING ‚Üí CONFIRMED` –∏–ª–∏ `PENDING ‚Üí CANCELLED` —Å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–µ–π |
| **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** | –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º `X-Request-Id` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
| **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** | –†–µ—Ç—Ä–∞–∏ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π, —Ç–∞–π–º–∞—É—Ç—ã, graceful degradation |
| **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –ø–æ–¥–±–æ—Ä** | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –Ω–æ–º–µ—Ä–æ–≤ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π (`times_booked ASC`) |
| **–°–∫–≤–æ–∑–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞** | –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ `X-Request-Id` —á–µ—Ä–µ–∑ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã |

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û–±–∑–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (C4 Container Level)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                              HOTEL RESERVATION SYSTEM                           ‚îÇ
‚îÇ                                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ                         Service Discovery Layer                          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ                    EUREKA SERVER (:8761)                        ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ Service Registry                                             ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ Health Monitoring                                            ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ Dashboard UI: http://localhost:8761                          ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                       ‚ñ≤                                         ‚îÇ
‚îÇ                                       ‚îÇ Register/Heartbeat                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ                          API Gateway Layer                              ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ                      GATEWAY (:8080)                            ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ Request Routing (Spring Cloud Gateway)                       ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ JWT Validation                                               ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ X-Request-Id Generation/Propagation                          ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ CORS Handling                                                ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ‚Ä¢ /internal/** Blocking (404)                                  ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                       ‚îÇ                                         ‚îÇ
‚îÇ                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                     ‚îÇ
‚îÇ                    ‚ñº                                      ‚ñº                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ       BOOKING API (:8082)       ‚îÇ  ‚îÇ       HOTEL API (:8081)         ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ                                 ‚îÇ  ‚îÇ                                 ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  Responsibilities:              ‚îÇ  ‚îÇ  Responsibilities:              ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ User Registration/Auth       ‚îÇ  ‚îÇ  ‚Ä¢ Hotel CRUD                   ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ JWT Token Issuance           ‚îÇ  ‚îÇ  ‚Ä¢ Room CRUD                    ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Booking Management           ‚îÇ  ‚îÇ  ‚Ä¢ Room Availability Check      ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Saga Orchestration           ‚îÇ  ‚îÇ  ‚Ä¢ Room Recommendations         ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Idempotency (X-Request-Id)   ‚îÇ  ‚îÇ  ‚Ä¢ Hold/Release Slots           ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ                                 ‚îÇ  ‚îÇ  ‚Ä¢ times_booked Statistics      ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  Entities: User, Booking        ‚îÇ  ‚îÇ  Entities: Hotel, Room          ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  Tables: users, bookings        ‚îÇ  ‚îÇ  Tables: hotels, rooms          ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ                                 ‚îÇ  ‚îÇ                                 ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ    H2 Database        ‚îÇ      ‚îÇ  ‚îÇ  ‚îÇ    H2 Database        ‚îÇ      ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ    (In-Memory)        ‚îÇ      ‚îÇ  ‚îÇ  ‚îÇ    (In-Memory)        ‚îÇ      ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ                    ‚îÇ                                      ‚ñ≤                     ‚îÇ
‚îÇ                    ‚îÇ         HTTP (RestTemplate)          ‚îÇ                     ‚îÇ
‚îÇ                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                     ‚îÇ
‚îÇ                              Saga: confirm/release                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

| –ü—É—Ç—å | –°–µ—Ä–≤–∏—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|
| `/api/hotels/**` | Hotel API | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–µ–ª—è–º–∏ |
| `/api/rooms/**` | Hotel API | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞–º–∏ |
| `/booking/**` | Booking API | –û–ø–µ—Ä–∞—Ü–∏–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è |
| `/bookings/**` | Booking API | –°–ø–∏—Å–æ–∫ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π |
| `/user/**` | Booking API | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| `/internal/**` | ‚Äî | **–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (404)** |

### –ü–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (Saga Pattern)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Client   ‚îÇ      ‚îÇ    Booking API    ‚îÇ      ‚îÇ    Hotel API    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îÇ  POST /booking        ‚îÇ                         ‚îÇ
      ‚îÇ  + X-Request-Id       ‚îÇ                         ‚îÇ
      ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ                         ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îÇ                       ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
      ‚îÇ                       ‚îÇ ‚îÇ 1. Check Idempotency‚îÇ ‚îÇ
      ‚îÇ                       ‚îÇ ‚îÇ    (by X-Request-Id)‚îÇ ‚îÇ
      ‚îÇ                       ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îÇ                       ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
      ‚îÇ                       ‚îÇ ‚îÇ 2. Create Booking   ‚îÇ ‚îÇ
      ‚îÇ                       ‚îÇ ‚îÇ    status: PENDING  ‚îÇ ‚îÇ
      ‚îÇ                       ‚îÇ ‚îÇ    @Transactional   ‚îÇ ‚îÇ
      ‚îÇ                       ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îÇ                       ‚îÇ POST /internal/rooms/{id}/confirm-availability
      ‚îÇ                       ‚îÇ + requestId, start, end ‚îÇ
      ‚îÇ                       ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚îÇ                       ‚îÇ                         ‚îÇ ‚îÇ 3. Check Dates  ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ ‚îÇ 4. Create HOLD  ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ ‚îÇ 5. times_booked++‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îÇ                       ‚îÇ    200 OK / 409 Conflict‚îÇ
      ‚îÇ                       ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îÇ      [SUCCESS]        ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
      ‚îÇ                       ‚îÇ ‚îÇ 6a. Update Booking  ‚îÇ ‚îÇ
      ‚îÇ                       ‚îÇ ‚îÇ     ‚Üí CONFIRMED     ‚îÇ ‚îÇ
      ‚îÇ                       ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îÇ      [FAILURE]        ‚îÇ POST /internal/rooms/{id}/release
      ‚îÇ                       ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚îÇ                       ‚îÇ                         ‚îÇ ‚îÇ 6b. Remove HOLD ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ ‚îÇ times_booked--  ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îÇ                       ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
      ‚îÇ                       ‚îÇ ‚îÇ 7b. Update Booking  ‚îÇ ‚îÇ
      ‚îÇ                       ‚îÇ ‚îÇ     ‚Üí CANCELLED     ‚îÇ ‚îÇ
      ‚îÇ                       ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
      ‚îÇ                       ‚îÇ                         ‚îÇ
      ‚îÇ  Response (JSON)      ‚îÇ                         ‚îÇ
      ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                         ‚îÇ
      ‚îÇ                       ‚îÇ                         ‚îÇ
```

### –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

**Booking API (H2)**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ            USERS                ‚îÇ       ‚îÇ           BOOKINGS              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id          BIGINT (PK)         ‚îÇ       ‚îÇ id          BIGINT (PK)         ‚îÇ
‚îÇ username    VARCHAR (UNIQUE)    ‚îÇ       ‚îÇ user_id     BIGINT (FK ‚Üí users) ‚îÇ
‚îÇ password    VARCHAR             ‚îÇ       ‚îÇ room_id     BIGINT              ‚îÇ
‚îÇ role        VARCHAR             ‚îÇ       ‚îÇ start_date  DATE                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ end_date    DATE                ‚îÇ
                                          ‚îÇ status      VARCHAR             ‚îÇ
                                          ‚îÇ request_id  VARCHAR (UNIQUE)    ‚îÇ
                                          ‚îÇ created_at  TIMESTAMP           ‚îÇ
                                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Hotel API (H2)**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ            HOTELS               ‚îÇ       ‚îÇ            ROOMS                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id          BIGINT (PK)         ‚îÇ       ‚îÇ id          BIGINT (PK)         ‚îÇ
‚îÇ name        VARCHAR             ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ hotel_id    BIGINT (FK)         ‚îÇ
‚îÇ city        VARCHAR             ‚îÇ       ‚îÇ number      VARCHAR             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ available   BOOLEAN             ‚îÇ
                                          ‚îÇ times_booked INT                ‚îÇ
                                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        ROOM_RESERVATIONS        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id          BIGINT (PK)         ‚îÇ
‚îÇ room_id     BIGINT (FK ‚Üí rooms) ‚îÇ
‚îÇ request_id  VARCHAR (UNIQUE)    ‚îÇ
‚îÇ start_date  DATE                ‚îÇ
‚îÇ end_date    DATE                ‚îÇ
‚îÇ status      VARCHAR (HELD/...)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (ADR)

### ADR-0001: –°–∞–≥–∞ (–¥–≤—É—Ö—à–∞–≥–æ–≤–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å) –≤–º–µ—Å—Ç–æ 2PC

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:**  
–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É Booking API –∏ Hotel API –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

**–†–µ—à–µ–Ω–∏–µ:**  
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∞–≥–∞-–ø–æ–¥—Ö–æ–¥ —Å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–µ–π:

1. **Booking API:** —Å–æ–∑–¥–∞—ë—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `PENDING` (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è)
2. **Hotel API:** `confirm-availability` ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–ª–æ—Ç–∞ (HELD)
3. **–ü—Ä–∏ —É—Å–ø–µ—Ö–µ:** —Å—Ç–∞—Ç—É—Å ‚Üí `CONFIRMED`, –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç `times_booked`
4. **–ü—Ä–∏ —Å–±–æ–µ/—Ç–∞–π–º–∞—É—Ç–µ:** –≤—ã–∑–æ–≤ `release`, —Å—Ç–∞—Ç—É—Å ‚Üí `CANCELLED`

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –¢–ó (–±–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)
- –ß—ë—Ç–∫–∞—è –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∞—è –ª–æ–≥–∏–∫–∞
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è —É—á–µ–±–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
- –ù–µ–æ–±—Ö–æ–¥–∏–º—ã —Ä–µ—Ç—Ä–∞–∏ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π

---

### ADR-0002: –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø–æ X-Request-Id

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:**  
–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—Ä–µ—Ç—Ä–∞–∏, –¥–≤—É–∫—Ä–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞) –Ω–µ –¥–æ–ª–∂–Ω—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã.

**–†–µ—à–µ–Ω–∏–µ:**  
–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Request-Id` (UUID v4) –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö POST-–æ–ø–µ—Ä–∞—Ü–∏–π:
- –•—Ä–∞–Ω–µ–Ω–∏–µ `request_id` —Å `UNIQUE` constraint –≤ –ë–î
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ (400 –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏)
- Gateway –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `X-Request-Id` –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω –∫–ª–∏–µ–Ω—Ç–æ–º
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –æ–ø–∏—Ä–∞—é—Ç—Å—è –Ω–∞ `requestId` (MDC)

---

### ADR-0003: JWT HS256 –¥–ª—è DEV-–æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:**  
–¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å TTL=1 —á–∞—Å –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∑–∞—Ç—Ä–∞—Ç–∞–º–∏ –Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É.

**–†–µ—à–µ–Ω–∏–µ:**  
–°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º HS256 —Å –æ–±—â–∏–º —Å–µ–∫—Ä–µ—Ç–æ–º –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:
- Booking API ‚Äî –≤—ã–ø—É—Å–∫–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã
- Hotel API, API Gateway ‚Äî –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç —Ç–æ–∫–µ–Ω—ã (Resource Server)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –ê–ª–≥–æ—Ä–∏—Ç–º | HS256 |
| TTL | 3600 —Å–µ–∫—É–Ω–¥ |
| Claim —Ä–æ–ª–∏ | `role` (`ROLE_USER` / `ROLE_ADMIN`) |

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –±–µ–∑ –≤–Ω–µ—à–Ω–µ–≥–æ Identity Provider
- –î–ª—è production –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ RS256/Keycloak

---

### ADR-0004: In-memory H2 –∫–∞–∫ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:**  
–¢–ó —Ç—Ä–µ–±—É–µ—Ç in-memory –ë–î –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.

**–†–µ—à–µ–Ω–∏–µ:**  
H2 Database –≤ —Ä–µ–∂–∏–º–µ `mem:` —Å:
- `spring.jpa.hibernate.ddl-auto=update`
- Seed-—Å–∫—Ä–∏–ø—Ç—ã (`data.sql`) –¥–ª—è DEV-–ø—Ä–æ—Ñ–∏–ª—è

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –î–∞–Ω–Ω—ã–µ —ç—Ñ–µ–º–µ—Ä–Ω—ã (—Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ)
- –£–ø—Ä–æ—â–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–Ω–µ—à–Ω—è—è –°–£–ë–î

---

### ADR-0005: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ times_booked

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:**  
–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –Ω–æ–º–µ—Ä–∞.

**–†–µ—à–µ–Ω–∏–µ:**  
- Hotel API —Ö—Ä–∞–Ω–∏—Ç —Å—á—ë—Ç—á–∏–∫ `rooms.times_booked`
- –ü—Ä–∏ `confirm-availability` ‚Üí `times_booked++`
- –ü—Ä–∏ `release` (–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è) ‚Üí `times_booked--`
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: —Ñ–∏–ª—å—Ç—Ä —Å–≤–æ–±–æ–¥–Ω—ã—Ö + —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ `(times_booked ASC, id ASC)`

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–≤—Ç–æ–ø–æ–¥–±–æ—Ä –Ω–æ–º–µ—Ä–∞
- –†–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ñ–æ–Ω–¥–∞
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—á—ë—Ç—á–∏–∫–∞ —á–µ—Ä–µ–∑ `requestId`

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|--------|------------|
| Java | 17-21 | –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è |
| Spring Boot | 3.4.x | –§—Ä–µ–π–º–≤–æ—Ä–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| Spring Cloud | 2024.x | –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ |
| Spring Cloud Gateway | ‚Äî | API Gateway (WebFlux) |
| Spring Cloud Eureka | ‚Äî | Service Discovery |
| Spring Security | 6.x | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ JWT |
| Spring Data JPA | ‚Äî | –†–∞–±–æ—Ç–∞ —Å –ë–î |
| Hibernate | 6.x | ORM |
| H2 Database | ‚Äî | In-memory –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |

### –£—Ç–∏–ª–∏—Ç—ã

| –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|------------|
| Lombok | –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ boilerplate-–∫–æ–¥–∞ |
| MapStruct | –ú–∞–ø–ø–∏–Ω–≥ DTO ‚Üî Entity |
| JJWT | –†–∞–±–æ—Ç–∞ —Å JWT-—Ç–æ–∫–µ–Ω–∞–º–∏ |
| WireMock | –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP –¥–ª—è —Ç–µ—Å—Ç–æ–≤ |

### –°–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|------------|
| Maven 3.9+ | –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ |
| JUnit 5 | Unit-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| MockMvc | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
hotel-reservation-system/
‚îú‚îÄ‚îÄ pom.xml                          # –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π POM (BOM)
‚îú‚îÄ‚îÄ Makefile                         # –ö–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ README.md                        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ common-lib/                      # –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ src/main/java/ru/mephi/commonlib/
‚îÇ       ‚îú‚îÄ‚îÄ error/                   # Error envelope, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ       ‚îî‚îÄ‚îÄ support/                 # X-Request-Id —Ñ–∏–ª—å—Ç—Ä—ã, MDC
‚îÇ
‚îú‚îÄ‚îÄ service-registry/                # Service Registry
‚îÇ   ‚îî‚îÄ‚îÄ src/main/java/ru/mephi/registry/
‚îÇ       ‚îî‚îÄ‚îÄ DiscoveryEurekaApplication.java
‚îÇ
‚îú‚îÄ‚îÄ api-gateway/                     # API Gateway
‚îÇ   ‚îî‚îÄ‚îÄ src/main/java/ru/mephi/apigateway/
‚îÇ       ‚îú‚îÄ‚îÄ GatewayApplication.java
‚îÇ       ‚îú‚îÄ‚îÄ filter/                  # RequestIdGatewayFilter, LoggingMdcGlobalFilter
‚îÇ       ‚îî‚îÄ‚îÄ config/                  # –†–æ—É—Ç–∏–Ω–≥, CORS, Security
‚îÇ
‚îú‚îÄ‚îÄ hotel-api/                       # Hotel Management API
‚îÇ   ‚îî‚îÄ‚îÄ src/main/java/ru/mephi/hotelapi/
‚îÇ       ‚îú‚îÄ‚îÄ domain/                  # Entities: Hotel, Room, RoomReservation
‚îÇ       ‚îú‚îÄ‚îÄ repo/                    # JPA Repositories
‚îÇ       ‚îú‚îÄ‚îÄ service/                 # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ       ‚îî‚îÄ‚îÄ web/                     # REST Controllers, DTOs
‚îÇ
‚îî‚îÄ‚îÄ booking-api/                     # Booking API
    ‚îî‚îÄ‚îÄ src/main/java/ru/mephi/bookingapi/
        ‚îú‚îÄ‚îÄ domain/                  # Entities: User, Booking
        ‚îú‚îÄ‚îÄ repo/                    # JPA Repositories
        ‚îú‚îÄ‚îÄ client/                  # HTTP-–∫–ª–∏–µ–Ω—Ç –∫ Hotel API
        ‚îú‚îÄ‚îÄ config/                  # Security, JWT, Properties
        ‚îî‚îÄ‚îÄ web/                     # REST Controllers, DTOs
```

---

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –í–µ—Ä—Å–∏—è | –ü—Ä–æ–≤–µ—Ä–∫–∞ |
|------------|--------|----------|
| Java | 17, 18, 19, 20, 21 | `java -version` |
| Maven | 3.9+ | `mvn -version` |
| –ü–æ—Ä—Ç—ã | 8761, 8080, 8081, 8082 | —Å–≤–æ–±–æ–¥–Ω—ã |

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** Java 22+ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∏–∑-–∑–∞ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å Lombok

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ Java
java -version
# –û–∂–∏–¥–∞–µ—Ç—Å—è: openjdk version "21.0.x" –∏–ª–∏ 17-20

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ Maven
mvn -version
# –û–∂–∏–¥–∞–µ—Ç—Å—è: Apache Maven 3.9.x

# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Maven –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é Java
mvn -version | grep "Java version"

# –ü—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏:
export JAVA_HOME=$(/usr/libexec/java_home -v 21)  # macOS
export JAVA_HOME=/usr/lib/jvm/java-21-openjdk     # Linux
```

### –®–∞–≥ 2: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–±–æ—Ä–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone <repository-url>
cd hotel-reservation-system

# –°–±–æ—Ä–∫–∞ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º!)
mvn clean install -DskipTests

# –ò–ª–∏ —Å –ø—Ä–æ–≥–æ–Ω–æ–º —Ç–µ—Å—Ç–æ–≤
mvn clean install
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Makefile –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

```bash
# JWT —Å–µ–∫—Ä–µ—Ç (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ Maven –Ω–∞–ø—Ä—è–º—É—é)
export AUTH_JWT_SECRET=dev-secret-0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCD
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

> **–ü–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞ –≤–∞–∂–µ–Ω!** Eureka –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –ø–µ—Ä–≤—ã–º.

**–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ Makefile (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

–û—Ç–∫—Ä–æ–π—Ç–µ 4 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1 ‚Äî Service Registry (–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤—ã–º!)
make registry
# –î–æ–∂–¥–∏—Ç–µ—Å—å: "Started DiscoveryEurekaApplication"

# –¢–µ—Ä–º–∏–Ω–∞–ª 2 ‚Äî Hotel API
make hotel
# –î–æ–∂–¥–∏—Ç–µ—Å—å: "Started HotelServiceApplication"

# –¢–µ—Ä–º–∏–Ω–∞–ª 3 ‚Äî Booking API
make booking
# –î–æ–∂–¥–∏—Ç–µ—Å—å: "Started BookingServiceApplication"

# –¢–µ—Ä–º–∏–Ω–∞–ª 4 ‚Äî API Gateway
make gateway
# –î–æ–∂–¥–∏—Ç–µ—Å—å: "Started GatewayApplication"
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ Maven –Ω–∞–ø—Ä—è–º—É—é**

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1 ‚Äî Service Registry
mvn -pl :service-registry spring-boot:run

# –¢–µ—Ä–º–∏–Ω–∞–ª 2 ‚Äî Hotel API
mvn -pl :hotel-api spring-boot:run

# –¢–µ—Ä–º–∏–Ω–∞–ª 3 ‚Äî Booking API
mvn -pl :booking-api spring-boot:run

# –¢–µ—Ä–º–∏–Ω–∞–ª 4 ‚Äî API Gateway
mvn -pl :api-gateway spring-boot:run
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# 1. Eureka Dashboard ‚Äî –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
open http://localhost:8761

# 2. Health-check –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
curl -s http://localhost:8081/actuator/health | jq  # Hotel API
curl -s http://localhost:8082/actuator/health | jq  # Booking API
curl -s http://localhost:8080/actuator/health | jq  # API Gateway

# 3. –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ Gateway
curl -s http://localhost:8080/api/hotels
# –û–∂–∏–¥–∞–µ—Ç—Å—è: [] (–ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤) –∏–ª–∏ 401 (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
```

### –®–∞–≥ 6: –ë—ã—Å—Ç—Ä—ã–π smoke-test

```bash
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
TOKEN=$(curl -s http://localhost:8080/user/register \
  -H 'Content-Type: application/json' \
  -d '{"username":"test","password":"test123","admin":true}' | jq -r .token)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
echo "Token: $TOKEN"

# –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–µ–ª—è
curl -s http://localhost:8080/api/hotels \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Request-Id: $(uuidgen)" \
  -H 'Content-Type: application/json' \
  -d '{"name":"Test Hotel","city":"Moscow"}' | jq

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ—Ç–µ–ª–µ–π
curl -s http://localhost:8080/api/hotels \
  -H "Authorization: Bearer $TOKEN" | jq
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

```yaml
auth:
  jwt:
    secret: ${AUTH_JWT_SECRET}
```

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –ê–ª–≥–æ—Ä–∏—Ç–º | HS256 |
| TTL —Ç–æ–∫–µ–Ω–∞ | 1 —á–∞—Å (3600 —Å–µ–∫) |
| –†–æ–ª–∏ | `ROLE_USER`, `ROLE_ADMIN` |

### –ü–æ—Ä—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤

| –°–µ—Ä–≤–∏—Å | –ü–æ—Ä—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|------|----------|
| Service Registry | 8761 | Eureka Server + Dashboard |
| API Gateway | 8080 | –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| Hotel API | 8081 | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–µ–ª—è–º–∏/–Ω–æ–º–µ—Ä–∞–º–∏ |
| Booking API | 8082 | –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ |

### –¢–∞–π–º–∞—É—Ç—ã –∏ —Ä–µ—Ç—Ä–∞–∏ (Booking API ‚Üí Hotel API)

```yaml
hotel-client:
  connect-timeout: 1000   # –º—Å
  read-timeout: 2000      # –º—Å
  retry-attempts: 3
  retry-delay: 100        # –º—Å
```

---

## API Reference

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```http
POST /user/register
Content-Type: application/json

{
  "username": "john_doe",
  "password": "secure123",
  "admin": false
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "expiresInSeconds": 3600
}
```

#### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

```http
POST /user/auth
Content-Type: application/json

{
  "username": "john_doe",
  "password": "secure123"
}
```

---

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–µ–ª—è–º–∏ (ADMIN)

#### –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–µ–ª—è

```http
POST /api/hotels
Authorization: Bearer <token>
X-Request-Id: <uuid>
Content-Type: application/json

{
  "name": "Grand Hotel",
  "city": "Moscow"
}
```

#### –°–ø–∏—Å–æ–∫ –æ—Ç–µ–ª–µ–π

```http
GET /api/hotels
Authorization: Bearer <token>
```

---

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞–º–∏ (ADMIN)

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞

```http
POST /api/rooms
Authorization: Bearer <token>
X-Request-Id: <uuid>
Content-Type: application/json

{
  "hotelId": 1,
  "number": "101",
  "available": true
}
```

#### –°–ø–∏—Å–æ–∫ –Ω–æ–º–µ—Ä–æ–≤ –æ—Ç–µ–ª—è

```http
GET /api/rooms?hotelId=1
Authorization: Bearer <token>
```

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –Ω–æ–º–µ—Ä–æ–≤

```http
GET /api/rooms/recommend?hotelId=1&start=2025-10-25&end=2025-10-27&limit=5
Authorization: Bearer <token>
```

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ –Ω–æ–º–µ—Ä–∞, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ `times_booked ASC, id ASC`.

---

### –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (USER)

#### –°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```http
POST /booking
Authorization: Bearer <token>
X-Request-Id: <uuid>
Content-Type: application/json

{
  "hotelId": 1,
  "roomId": 1,
  "start": "2025-10-25",
  "end": "2025-10-27",
  "autoSelect": false
}
```

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `autoSelect: true` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä –Ω–æ–º–µ—Ä–∞ (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç `roomId`) |
| `autoSelect: false` | –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –ø–æ `roomId` |

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": 1,
  "status": "CONFIRMED",
  "roomId": 1
}
```

#### –ò—Å—Ç–æ—Ä–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π

```http
GET /bookings
Authorization: Bearer <token>
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```http
GET /booking/{id}
Authorization: Bearer <token>
```

#### –û—Ç–º–µ–Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```http
DELETE /booking/{id}
Authorization: Bearer <token>
X-Request-Id: <uuid>
```

---

### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ Gateway)

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|----------|
| POST | `/internal/rooms/{id}/confirm-availability` | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–æ–º–µ—Ä–∞ |
| POST | `/internal/rooms/{id}/release?requestId=...` | –°–Ω—è—Ç–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è) |

> ‚ö†Ô∏è –ü—É—Ç–∏ `/internal/**` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 404 –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ —á–µ—Ä–µ–∑ Gateway.

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π: –æ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
TOKEN=$(curl -s http://localhost:8080/user/register \
  -H 'Content-Type: application/json' \
  -d '{"username":"admin","password":"admin123","admin":true}' | jq -r .token)

echo "Admin Token: $TOKEN"

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–µ–ª—è
curl -s http://localhost:8080/api/hotels \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Request-Id: $(uuidgen)" \
  -H 'Content-Type: application/json' \
  -d '{"name":"Cosmos Hotel","city":"Moscow"}'

# 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤
for room in 101 102 103; do
  curl -s http://localhost:8080/api/rooms \
    -H "Authorization: Bearer $TOKEN" \
    -H "X-Request-Id: $(uuidgen)" \
    -H 'Content-Type: application/json' \
    -d "{\"hotelId\":1,\"number\":\"$room\"}"
done

# 4. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
USER_TOKEN=$(curl -s http://localhost:8080/user/register \
  -H 'Content-Type: application/json' \
  -d '{"username":"user","password":"user123","admin":false}' | jq -r .token)

echo "User Token: $USER_TOKEN"

# 5. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
curl -s "http://localhost:8080/api/rooms/recommend?hotelId=1&start=2025-10-25&end=2025-10-27&limit=3" \
  -H "Authorization: Bearer $USER_TOKEN" \
  -H "X-Request-Id: $(uuidgen)" | jq

# 6. –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∞–≤—Ç–æ–ø–æ–¥–±–æ—Ä–æ–º
curl -s http://localhost:8080/booking \
  -H "Authorization: Bearer $USER_TOKEN" \
  -H "X-Request-Id: $(uuidgen)" \
  -H 'Content-Type: application/json' \
  -d '{"hotelId":1,"autoSelect":true,"start":"2025-10-25","end":"2025-10-27"}' | jq

# 7. –ü—Ä–æ—Å–º–æ—Ç—Ä –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
curl -s http://localhost:8080/bookings \
  -H "Authorization: Bearer $USER_TOKEN" \
  -H "X-Request-Id: $(uuidgen)" | jq
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

```bash
# –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ X-Request-Id ‚Äî –æ–¥–∏–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç
REQUEST_ID=$(uuidgen)

# –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å ‚Äî —Å–æ–∑–¥–∞—ë—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
curl -s http://localhost:8080/booking \
  -H "Authorization: Bearer $USER_TOKEN" \
  -H "X-Request-Id: $REQUEST_ID" \
  -H 'Content-Type: application/json' \
  -d '{"hotelId":1,"autoSelect":true,"start":"2025-11-01","end":"2025-11-03"}'

# –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ –∂–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–∞)
curl -s http://localhost:8080/booking \
  -H "Authorization: Bearer $USER_TOKEN" \
  -H "X-Request-Id: $REQUEST_ID" \
  -H 'Content-Type: application/json' \
  -d '{"hotelId":1,"autoSelect":true,"start":"2025-11-01","end":"2025-11-03"}'
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

```bash
# Unit + Integration —Ç–µ—Å—Ç—ã
mvn clean test

# –° –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏
mvn -DskipITs=false test

# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
make check

# –°–±–æ—Ä–∫–∞ –±–µ–∑ —Ç–µ—Å—Ç–æ–≤
make build
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

| –ú–æ–¥—É–ª—å | –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ |
|--------|-------------------|
| **booking-api** | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, —Å–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (WireMock HMS), –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã, expired JWT |
| **hotel-api** | CRUD –æ—Ç–µ–ª–µ–π/–Ω–æ–º–µ—Ä–æ–≤, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, confirm/release, —Ä–æ–ª–∏, –≤–∞–ª–∏–¥–∞—Ü–∏–∏ |
| **api-gateway** | –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ `/internal/**`, CORS, –ø—Ä–æ–±—Ä–æ—Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ |
| **common-lib** | –§–∏–ª—å—Ç—Ä—ã, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—à–∏–±–æ–∫ |

---

## –û–±—Å–µ—Ä–≤–∞–±–∏–ª–∏—Ç–∏

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

MDC-–∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏:

| –ö–ª—é—á | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `requestId` | –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π ID –∏–∑ `X-Request-Id` |
| `userId` | ID –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `bookingId` | ID –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–≥–¥–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ) |

### Health Checks

```bash
curl http://localhost:8080/actuator/health
curl http://localhost:8081/actuator/health
curl http://localhost:8082/actuator/health
```

### –ú–µ—Ç—Ä–∏–∫–∏ (Prometheus)

```bash
curl http://localhost:8081/actuator/prometheus
curl http://localhost:8082/actuator/prometheus
```

### Error Envelope

–í—Å–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –µ–¥–∏–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```json
{
  "timestamp": "2025-01-14T12:00:00.000Z",
  "status": 409,
  "error": "Conflict",
  "message": "Room is not available for selected dates",
  "requestId": "550e8400-e29b-41d4-a716-446655440000"
}
```

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞: `Could not resolve dependencies for project ru.mephi:hotel-api`

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–æ–¥—É–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π Maven-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

```bash
# –†–µ—à–µ–Ω–∏–µ: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –º–æ–¥—É–ª–∏
mvn clean install -DskipTests
```

### –û—à–∏–±–∫–∞: `ExceptionInInitializerError: TypeTag :: UNKNOWN`

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å Lombok —Å Java 22+.

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é Java –¥–ª—è Maven
mvn -version | grep "Java version"

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Java 21
export JAVA_HOME=$(/usr/libexec/java_home -v 21)  # macOS
```

### –°–µ—Ä–≤–∏—Å –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ Eureka

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Eureka –∑–∞–ø—É—â–µ–Ω –ø–µ—Ä–≤—ã–º
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 30 —Å–µ–∫—É–Ω–¥ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –æ—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### 401 Unauthorized –ø—Ä–∏ –≤—ã–∑–æ–≤–µ API

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–æ–∫–µ–Ω –Ω–µ –∏—Å—Ç—ë–∫ (TTL = 1 —á–∞—Å)
# –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
curl -s http://localhost:8080/user/auth \
  -H 'Content-Type: application/json' \
  -d '{"username":"admin","password":"admin123"}'
```

### 404 –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `/internal/**` —á–µ—Ä–µ–∑ Gateway

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ Gateway.  
–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ –∫ —Å–µ—Ä–≤–∏—Å—É (–ø–æ—Ä—Ç 8081).